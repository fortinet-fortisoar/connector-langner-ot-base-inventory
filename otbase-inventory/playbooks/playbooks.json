{
  "type": "workflow_collections",
  "data": [
    {
      "uuid": "0852c21b-b9fc-48b4-bdbe-da7dd06d8298",
      "@type": "WorkflowCollection",
      "workflows": [
        {
          "@type": "Workflow",
          "uuid": "274118f5-d574-41a8-9a62-d366f0ed5d3b",
          "collection": "/api/3/workflow_collections/0852c21b-b9fc-48b4-bdbe-da7dd06d8298",
          "steps": [
            {
              "uuid": "d32ef278-88b5-444b-a3e0-01e4a6ba4698",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62"
            },
            {
              "uuid": "eda95911-5d5d-4b52-9f2e-433b40fcb222",
              "@type": "WorkflowStep",
              "name": "Get Devices List",
              "description": null,
              "status": null,
              "arguments": {
                "name": "OTbase Inventory",
                "config": "",
                "params": {
                  "name": "",
                  "locationid": "",
                  "otsystemid": "",
                  "otsystem": "",
                  "ipaddress": "",
                  "include": "",
                  "networkid": "",
                  "modified": "",
                  "count": 300,
                  "offset": ""
                },
                "version": "1.0.1",
                "connector": "otbase-inventory",
                "operation": "get_devices_list",
                "operationTitle": "Get Devices List"
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "triggerLimit": null,
          "description": "Retrieves a list of devices from OTbase Inventory based on the input parameters you have specified.",
          "name": "Get Devices List",
          "tag": "#OTbase Inventory",
          "recordTags": [
            "Otbase",
            "otbase-inventory"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/d32ef278-88b5-444b-a3e0-01e4a6ba4698",
          "routes": [
            {
              "uuid": "bc7cc6c3-9e8e-4730-bcec-02aa574dd0cf",
              "@type": "WorkflowRoute",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Devices List",
              "sourceStep": "/api/3/workflow_steps/d32ef278-88b5-444b-a3e0-01e4a6ba4698",
              "targetStep": "/api/3/workflow_steps/eda95911-5d5d-4b52-9f2e-433b40fcb222"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "88cbe485-8dbe-4342-a7da-c0971a7cc492",
          "collection": "/api/3/workflow_collections/0852c21b-b9fc-48b4-bdbe-da7dd06d8298",
          "steps": [
            {
              "uuid": "077eeddc-6c08-4dda-b325-7894f5f3c89d",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62"
            },
            {
              "uuid": "17841835-d7ed-458b-b6a9-1e268e3e6eb5",
              "@type": "WorkflowStep",
              "name": "Get Device Details",
              "description": null,
              "status": null,
              "arguments": {
                "name": "OTbase Inventory",
                "config": "",
                "params": {
                  "device_id": "",
                  "include": ""
                },
                "version": "1.0.1",
                "connector": "otbase-inventory",
                "operation": "get_device_details",
                "operationTitle": "Get Device Details"
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "triggerLimit": null,
          "description": "Retrieves a specific device information from OTbase Inventory based on the device ID and include data you have specified.",
          "name": "Get Device Details",
          "tag": "#OTbase Inventory",
          "recordTags": [
            "Otbase",
            "otbase-inventory"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/077eeddc-6c08-4dda-b325-7894f5f3c89d",
          "routes": [
            {
              "uuid": "75e8f496-99fd-4a05-a409-8773e3a3e10e",
              "@type": "WorkflowRoute",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Device Details",
              "sourceStep": "/api/3/workflow_steps/077eeddc-6c08-4dda-b325-7894f5f3c89d",
              "targetStep": "/api/3/workflow_steps/17841835-d7ed-458b-b6a9-1e268e3e6eb5"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "5edcb293-d18f-498e-b355-e8831f096149",
          "collection": "/api/3/workflow_collections/0852c21b-b9fc-48b4-bdbe-da7dd06d8298",
          "steps": [
            {
              "uuid": "cd6ee648-1914-47d2-8c1c-39412dd6e356",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62"
            },
            {
              "uuid": "f86dcc0d-8859-45ff-87dd-0adb8db731e5",
              "@type": "WorkflowStep",
              "name": "Delete Device Details",
              "description": null,
              "status": null,
              "arguments": {
                "name": "OTbase Inventory",
                "config": "",
                "params": {
                  "device_id": ""
                },
                "version": "1.0.1",
                "connector": "otbase-inventory",
                "operation": "delete_device_details",
                "operationTitle": "Delete Device Details"
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "triggerLimit": null,
          "description": "Deletes an specific device information from OTbase Inventory based on the device ID you have specified.",
          "name": "Delete Device Details",
          "tag": "#OTbase Inventory",
          "recordTags": [
            "Otbase",
            "otbase-inventory"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/cd6ee648-1914-47d2-8c1c-39412dd6e356",
          "routes": [
            {
              "uuid": "7dac1247-50d3-4c9e-8688-8577c1f9351d",
              "@type": "WorkflowRoute",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Delete Device Details",
              "sourceStep": "/api/3/workflow_steps/cd6ee648-1914-47d2-8c1c-39412dd6e356",
              "targetStep": "/api/3/workflow_steps/f86dcc0d-8859-45ff-87dd-0adb8db731e5"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "305a48a2-e209-4c73-adf0-e9980462481e",
          "collection": "/api/3/workflow_collections/0852c21b-b9fc-48b4-bdbe-da7dd06d8298",
          "steps": [
            {
              "uuid": "3291a74a-cf3a-4080-82b3-4988730cede2",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62"
            },
            {
              "uuid": "b3ce1749-29ff-41e1-889c-0387421dc2d8",
              "@type": "WorkflowStep",
              "name": "Get Vulnerabilities List",
              "description": null,
              "status": null,
              "arguments": {
                "name": "OTbase Inventory",
                "config": "",
                "params": {
                  "priority": "",
                  "locationid": ""
                },
                "version": "1.0.1",
                "connector": "otbase-inventory",
                "operation": "get_vulnerabilities_list",
                "operationTitle": "Get Vulnerabilities List"
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "triggerLimit": null,
          "description": "Retrieves a list of vulnerabilities from OTbase Inventory based on the input parameters you have specified.",
          "name": "Get Vulnerabilities List",
          "tag": "#OTbase Inventory",
          "recordTags": [
            "Otbase",
            "otbase-inventory"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/3291a74a-cf3a-4080-82b3-4988730cede2",
          "routes": [
            {
              "uuid": "8f72948e-b842-45ff-8ca4-9051997cb350",
              "@type": "WorkflowRoute",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Vulnerabilities List",
              "sourceStep": "/api/3/workflow_steps/3291a74a-cf3a-4080-82b3-4988730cede2",
              "targetStep": "/api/3/workflow_steps/b3ce1749-29ff-41e1-889c-0387421dc2d8"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "fed683a2-ad32-4483-bb6f-f353eda142dd",
          "collection": "/api/3/workflow_collections/0852c21b-b9fc-48b4-bdbe-da7dd06d8298",
          "steps": [
            {
              "uuid": "3943b8f5-f66a-4607-9961-f078661aaa2e",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62"
            },
            {
              "uuid": "c396f178-0892-49ae-9fa7-9e4a86b8336d",
              "@type": "WorkflowStep",
              "name": "Get Vulnerability Details",
              "description": null,
              "status": null,
              "arguments": {
                "name": "OTbase Inventory",
                "config": "",
                "params": {
                  "cve_id": ""
                },
                "version": "1.0.1",
                "connector": "otbase-inventory",
                "operation": "get_vulnerability_details",
                "operationTitle": "Get Vulnerability Details"
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "triggerLimit": null,
          "description": "Retrieves a specific vulnerability information from OTbase Inventory based on the CVE ID you have specified.",
          "name": "Get Vulnerability Details",
          "tag": "#OTbase Inventory",
          "recordTags": [
            "Otbase",
            "otbase-inventory"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/3943b8f5-f66a-4607-9961-f078661aaa2e",
          "routes": [
            {
              "uuid": "3efad5d1-db3e-400b-a268-08b3e079c18f",
              "@type": "WorkflowRoute",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Vulnerability Details",
              "sourceStep": "/api/3/workflow_steps/3943b8f5-f66a-4607-9961-f078661aaa2e",
              "targetStep": "/api/3/workflow_steps/c396f178-0892-49ae-9fa7-9e4a86b8336d"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "8135ab99-6e9c-4f32-b1db-e3059e86b70c",
          "collection": "/api/3/workflow_collections/0852c21b-b9fc-48b4-bdbe-da7dd06d8298",
          "steps": [
            {
              "uuid": "a28bce32-99a8-47a8-8b71-8998323a42d0",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62"
            },
            {
              "uuid": "1bbe81b7-2857-4ba8-b2da-b5fa971f36b2",
              "@type": "WorkflowStep",
              "name": "Get Data Flow",
              "description": null,
              "status": null,
              "arguments": {
                "name": "OTbase Inventory",
                "config": "",
                "params": {
                  "last_seen": ""
                },
                "version": "1.0.1",
                "connector": "otbase-inventory",
                "operation": "get_data_flow",
                "operationTitle": "Get Data Flow"
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "triggerLimit": null,
          "description": "Retrieves a list of data flow from OTbase Inventory based on the input parameter you have specified.",
          "name": "Get Data Flow",
          "tag": "#OTbase Inventory",
          "recordTags": [
            "Otbase",
            "otbase-inventory"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/a28bce32-99a8-47a8-8b71-8998323a42d0",
          "routes": [
            {
              "uuid": "83bdbac6-87e6-442e-b570-94a8a3f2856f",
              "@type": "WorkflowRoute",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Data Flow",
              "sourceStep": "/api/3/workflow_steps/a28bce32-99a8-47a8-8b71-8998323a42d0",
              "targetStep": "/api/3/workflow_steps/1bbe81b7-2857-4ba8-b2da-b5fa971f36b2"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "9b89602d-0667-4700-9087-871d66d361ba",
          "collection": "/api/3/workflow_collections/0852c21b-b9fc-48b4-bdbe-da7dd06d8298",
          "steps": [
            {
              "uuid": "42c0f74f-1f14-42f7-8771-2f63e31e1322",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62"
            },
            {
              "uuid": "1c17eb0b-f2a9-45e2-ba31-8c38571197bb",
              "@type": "WorkflowStep",
              "name": "Get Network List",
              "description": null,
              "status": null,
              "arguments": {
                "name": "OTbase Inventory",
                "config": "",
                "params": {
                  "offset": ""
                },
                "version": "1.0.1",
                "connector": "otbase-inventory",
                "operation": "get_network_list",
                "operationTitle": "Get Network List"
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "triggerLimit": null,
          "description": "Retrieves a list of networks from OTbase Inventory based on the input parameter you have specified.",
          "name": "Get Network List",
          "tag": "#OTbase Inventory",
          "recordTags": [
            "Otbase",
            "otbase-inventory"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/42c0f74f-1f14-42f7-8771-2f63e31e1322",
          "routes": [
            {
              "uuid": "5be11608-c7e5-448e-a4a5-53d8decca24d",
              "@type": "WorkflowRoute",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Network List",
              "sourceStep": "/api/3/workflow_steps/42c0f74f-1f14-42f7-8771-2f63e31e1322",
              "targetStep": "/api/3/workflow_steps/1c17eb0b-f2a9-45e2-ba31-8c38571197bb"
            }
          ]
        },
        {
          "@type": "Workflow",
          "uuid": "22dd5b4f-25ec-44a3-a744-36802ccc0b50",
          "collection": "/api/3/workflow_collections/0852c21b-b9fc-48b4-bdbe-da7dd06d8298",
          "steps": [
            {
              "uuid": "dbf6e1bf-992f-4ede-946d-ea566e9f026c",
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "status": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "left": "20",
              "top": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62"
            },
            {
              "uuid": "4325787f-c240-45c9-81ba-888f02710332",
              "@type": "WorkflowStep",
              "name": "Get Network Details",
              "description": null,
              "status": null,
              "arguments": {
                "name": "OTbase Inventory",
                "config": "",
                "params": {
                  "network_id": ""
                },
                "version": "1.0.1",
                "connector": "otbase-inventory",
                "operation": "get_network_details",
                "operationTitle": "Get Network Details"
              },
              "left": "188",
              "top": "120",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671"
            }
          ],
          "triggerLimit": null,
          "description": "Retrieves a specific network information from OTbase Inventory based on the network ID you have specified.",
          "name": "Get Network Details",
          "tag": "#OTbase Inventory",
          "recordTags": [
            "Otbase",
            "otbase-inventory"
          ],
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "parameters": [],
          "synchronous": false,
          "triggerStep": "/api/3/workflow_steps/dbf6e1bf-992f-4ede-946d-ea566e9f026c",
          "routes": [
            {
              "uuid": "fcd600ef-260e-48c3-abc6-4556fa942ca9",
              "@type": "WorkflowRoute",
              "label": null,
              "isExecuted": false,
              "name": "Start-> Get Network Details",
              "sourceStep": "/api/3/workflow_steps/dbf6e1bf-992f-4ede-946d-ea566e9f026c",
              "targetStep": "/api/3/workflow_steps/4325787f-c240-45c9-81ba-888f02710332"
            }
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "OTbase Inventory > Fetch and Create",
          "aliasName": null,
          "tag": null,
          "description": "Fetch Devices from OTbase Inventory",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1719214611,
          "collection": "/api/3/workflow_collections/0852c21b-b9fc-48b4-bdbe-da7dd06d8298",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/d40d103c-1120-4cd5-aca8-f7ff567ec401",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "location_id": "",
                "device_limit": "300",
                "pullTimeMacro": "OTbaseInventoryLastPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
              },
              "status": null,
              "top": "165",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "751eb35d-0952-42cd-84ba-fef23de3c8a1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "for_each": {
                  "item": "{{vars.devices_list}}",
                  "__bulk": true,
                  "parallel": false,
                  "condition": "",
                  "batch_size": 100
                },
                "resource": {
                  "ip": "{% if vars.item.connections | length > 0 %}{% set l=[] %}{% for i in vars.item.connections %}{% if i.L3Address %}{% set _ = l.append(i.L3Address)%}{%endif%}{% endfor %}{{l | join(',')}}{% endif %}",
                  "tag": "{{vars.item.tags | join(',')}}",
                  "name": "{{(vars.item.context.location | split('/'))[0]}} - {{vars.item.hardware.type}} - {{vars.item.name}}",
                  "level": "{{\"AssetLevel\" | picklist(vars.item.zone, \"@id\")}}",
                  "status": "/api/3/picklists/421c20cd-e63d-4e32-9a25-774b2155cd24",
                  "vendor": "{{vars.item.hardware.vendor}}",
                  "network": "{% if vars.item.connections | length > 0 %}{% set l=[] %}{% for i in vars.item.connections %}{% if i.networkId %}{% set _ = l.append(i.networkId)%}{%endif%}{% endfor %}{{l | join(',')}}{% endif %}",
                  "product": "{{vars.item.hardware.model}}",
                  "category": "/api/3/picklists/1bfa4142-b3f2-4945-8393-66228f9260d3",
                  "firmware": "{{vars.item.os_firmware}}",
                  "hostname": "{{vars.item.description}}",
                  "location": "{{vars.item.context.location}}",
                  "__replace": "true",
                  "assetType": "/api/3/picklists/f36137a5-aa8f-4532-aab5-e57a8d7420a1",
                  "deviceUid": "{{vars.item.deviceId}}",
                  "macAddress": "{% if vars.item.connections | length > 0 %}{% set l=[] %}{% for i in vars.item.connections %}{% if i.L2Address %}{% set _ = l.append(i.L2Address)%}{%endif%}{% endfor %}{{l | join(',')}}{% endif %}",
                  "recordTags": [
                    "/api/3/tags/otbase-inventory"
                  ],
                  "sourceData": "{{vars.item | toJSON}}",
                  "description": "{{vars.item.hardware.description}}\n\n<style>\n    table, th, td {\n    border: 1px solid black;\n    border-collapse: collapse;\n    }\n</style>\n<table border=\"1\" style=\"width:100%\">\n    <tr>\n        <th style=\"width:10%\">Name</th>\n        <th style=\"width:10%\">Device ID</th>\n        <th style=\"width:10%\">Description</th>\n        <th style=\"width:10%\">Criticality</th>\n        <th style=\"width:10%\">Vendor</th>\n        <th style=\"width:10%\">Vendor Link</th>\n        <th style=\"width:10%\">Model</th>\n        <th style=\"width:10%\">Stage</th>\n        <th style=\"width:10%\">Modified Time</th>\n    </tr>\n    <tbody>\n        <tr>\n            <td>\n        {% if vars.item['name']%}{{vars.item['name']}}{%else%}Not Found{%endif%}\n            </td>\n            <td>\n            {% if vars.item['deviceId']%}{{vars.item['deviceId']}}{%else%}Not Found{%endif%}\n            </td>\n            <td>\n            {% if vars.item['description']%}{{vars.item['description']}}{%else%}Not Found{%endif%}\n            </td>\n            <td>\n            {% if vars.item['criticality']%}{{vars.item['criticality']}}{%else%}Not Found{%endif%}\n            </td>\n            <td>\n            {% if vars.item['hardware'].vendor%}{{vars.item['hardware'].vendor}}{%else%}Not Found{%endif%}\n            </td>\n            <td>\n            {% if vars.item['hardware'].vendorLink%}{{vars.item['hardware'].vendorLink}}{%else%}Not Found{%endif%}\n            </td>\n            <td>\n            {% if vars.item['hardware'].model%}{{vars.item['hardware'].model}}{%else%}Not Found{%endif%}\n            </td>\n            <td>\n            {% if vars.item['stage']%}{{vars.item['stage']}}{%else%}Not Found{%endif%}\n            </td>\n            <td>\n            {% if vars.item['modified']%}{{vars.item['modified']}}{%else%}Not Found{%endif%}\n            </td>\n        </tr>\n    </tbody>\n</table>",
                  "serialNumber": "{{vars.item.hardware.orderNumber}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "/api/3/upsert/assets",
                "__recommend": [],
                "fieldOperation": {
                  "protocol": "Overwrite",
                  "recordTags": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "840",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "22544b42-ebef-4e16-b3b8-442e7b12a205"
            },
            {
              "@type": "WorkflowStep",
              "name": "Extract Value From Macro Value",
              "description": null,
              "arguments": {
                "last_pull_time": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) < 1%}{{arrow.utcnow().shift(minutes=-vars.fetch_devices_in_last_X_minutes).format('YYYY-MM-DD HH:mm:ss')}}{% else %}{{vars.steps.Get_Macro_Value.data['hydra:member'][0]['value']}}{% endif %}",
                "current_timestamp": "{{arrow.utcnow().format(\"YYYY-MM-DD HH:mm:ss\")}}"
              },
              "status": null,
              "top": "435",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "fbfab8ca-85ec-4688-ae24-6c75056f2d7f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Devices List",
              "description": null,
              "arguments": {
                "name": "OTbase Inventory",
                "config": "848dfda4-7e72-4e5d-b1e3-b5417ac88b21",
                "params": {
                  "name": "",
                  "count": "{{vars.device_limit}}",
                  "offset": 0,
                  "include": [
                    "All"
                  ],
                  "modified": "{{vars.last_pull_time}}",
                  "otsystem": "",
                  "ipaddress": "",
                  "networkid": "",
                  "locationid": "{{vars.location_id}}",
                  "otsystemid": ""
                },
                "version": "1.1.0",
                "connector": "otbase-inventory",
                "operation": "get_devices_list",
                "operationTitle": "Get Devices List",
                "pickFromTenant": false,
                "step_variables": {
                  "devices_list": "{{vars.steps.Fetch_Devices_List.data.data}}"
                }
              },
              "status": null,
              "top": "705",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "fa3ef598-ce7b-49a2-86b2-fd79ec5f252d"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Sample Devices",
              "description": null,
              "arguments": {
                "name": "OTbase Inventory",
                "config": "658da38e-6d63-4418-9421-fc1cdbd7a1ea",
                "params": {
                  "name": "",
                  "count": "5",
                  "offset": 0,
                  "include": [
                    "All"
                  ],
                  "modified": "{{vars.last_pull_time}}",
                  "otsystem": "",
                  "ipaddress": "",
                  "networkid": "",
                  "locationid": "{{vars.location_id}}",
                  "otsystemid": ""
                },
                "version": "1.1.0",
                "connector": "otbase-inventory",
                "operation": "get_devices_list",
                "operationTitle": "Get Devices List",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "705",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "f89ad3fd-91a3-4193-acf4-985848bd116f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.pullTimeMacro}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.3.1",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "300",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "6f82f3a5-7e00-44f9-ae5c-af2b1acbb65f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is Data Only For mapping",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes",
                    "step_iri": "/api/3/workflow_steps/f89ad3fd-91a3-4193-acf4-985848bd116f",
                    "condition": "{{ vars.request.env_setup == true }}",
                    "step_name": "Fetch Sample Devices"
                  },
                  {
                    "option": "No, For Ingestion",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/fa3ef598-ce7b-49a2-86b2-fd79ec5f252d",
                    "step_name": "Fetch Devices List"
                  }
                ],
                "step_variables": []
              },
              "status": null,
              "top": "570",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "450af2f3-f0bb-497d-b818-79d2b7c4adf3"
            },
            {
              "@type": "WorkflowStep",
              "name": "Output Step",
              "description": null,
              "arguments": {
                "data": "{{vars.steps.Fetch_Sample_Devices.data.data}}"
              },
              "status": null,
              "top": "840",
              "left": "475",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "0bffb7e5-34f6-4d6e-9ad1-8d66b89c4254"
            },
            {
              "@type": "WorkflowStep",
              "name": "Set Result",
              "description": null,
              "arguments": {
                "macro_name": "{{vars.pullTimeMacro}}",
                "updated_last_pull_time": "{{vars.current_timestamp}}"
              },
              "status": null,
              "top": "975",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "9ba5c391-f76a-49c3-a69b-4da1ba8a933f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "__triggerLimit": true,
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n   {\n      \"title\":\"Pull Devices Created or Updated in Last X min\",\n      \"required\":true,\n      \"editable\":true,\n      \"visible\":true,\n      \"type\":\"integer\",\n      \"name\":\"fetch_devices_in_last_X_minutes\",\n      \"tooltip\":\"Specify the timeframe in minutes to pull the devices for the first time.\"\n   },\n   {\n      \"title\":\"Device Location\",\n      \"name\":\"location_id\",\n      \"type\":\"text\",\n      \"tooltip\":\"Specify the Location ID through which you want to filter Devices\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true\n   },\n   {\n      \"title\":\"Limit\",\n      \"name\":\"device_limit\",\n      \"type\":\"integer\",\n      \"tooltip\":\"Specify the number of Devices you want to ingest. Default value is 300.\",\n      \"required\":false,\n      \"editable\":true,\n      \"visible\":true\n   }\n]"
                },
                "triggerOnSource": true,
                "triggerOnReplicate": false
              },
              "status": null,
              "top": "30",
              "left": "300",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "d40d103c-1120-4cd5-aca8-f7ff567ec401"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/6f82f3a5-7e00-44f9-ae5c-af2b1acbb65f",
              "sourceStep": "/api/3/workflow_steps/751eb35d-0952-42cd-84ba-fef23de3c8a1",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a61f2f7f-1fa2-4ef2-a1ef-da5dd8df7843"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Assets -> Set Result",
              "targetStep": "/api/3/workflow_steps/9ba5c391-f76a-49c3-a69b-4da1ba8a933f",
              "sourceStep": "/api/3/workflow_steps/22544b42-ebef-4e16-b3b8-442e7b12a205",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "d78501c2-b6d6-4482-a4a3-feb2039c4b31"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Extract Value From Macro Value -> Is Data Only For mapping",
              "targetStep": "/api/3/workflow_steps/450af2f3-f0bb-497d-b818-79d2b7c4adf3",
              "sourceStep": "/api/3/workflow_steps/fbfab8ca-85ec-4688-ae24-6c75056f2d7f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "23f8544a-e50c-4bc0-9ab1-6407e7398734"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Sample Devices -> Output Step",
              "targetStep": "/api/3/workflow_steps/0bffb7e5-34f6-4d6e-9ad1-8d66b89c4254",
              "sourceStep": "/api/3/workflow_steps/f89ad3fd-91a3-4193-acf4-985848bd116f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "242a1108-2c01-414e-86a9-fac590a446c3"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Devices -> Create Assets",
              "targetStep": "/api/3/workflow_steps/22544b42-ebef-4e16-b3b8-442e7b12a205",
              "sourceStep": "/api/3/workflow_steps/fa3ef598-ce7b-49a2-86b2-fd79ec5f252d",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "6c718265-36a9-4522-919f-cbcf6dae6cda"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Extract Value From Macro Value",
              "targetStep": "/api/3/workflow_steps/fbfab8ca-85ec-4688-ae24-6c75056f2d7f",
              "sourceStep": "/api/3/workflow_steps/6f82f3a5-7e00-44f9-ae5c-af2b1acbb65f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "ea397c4e-a012-44d8-a790-2f85c11384bc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Data Only For mapping -> Fetch Sample Devices",
              "targetStep": "/api/3/workflow_steps/f89ad3fd-91a3-4193-acf4-985848bd116f",
              "sourceStep": "/api/3/workflow_steps/450af2f3-f0bb-497d-b818-79d2b7c4adf3",
              "label": "Yes",
              "isExecuted": false,
              "group": null,
              "uuid": "9cf3e16b-3a2f-4a28-8937-1ac648f850ca"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is Data Only For mapping -> Get Devices",
              "targetStep": "/api/3/workflow_steps/fa3ef598-ce7b-49a2-86b2-fd79ec5f252d",
              "sourceStep": "/api/3/workflow_steps/450af2f3-f0bb-497d-b818-79d2b7c4adf3",
              "label": "No, For Ingestion",
              "isExecuted": false,
              "group": null,
              "uuid": "981619e9-1f2c-4788-b647-adfa7f800a4d"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/751eb35d-0952-42cd-84ba-fef23de3c8a1",
              "sourceStep": "/api/3/workflow_steps/d40d103c-1120-4cd5-aca8-f7ff567ec401",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f0f75227-2a62-4c59-81ef-07beeab0df92"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "dfdb72f0-f9ea-4b04-8b6c-3af2c50e3295",
          "id": 1079,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "create",
            "dataingestion",
            "fetch",
            "Otbase",
            "otbase-inventory"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "OTbase Inventory > Ingest",
          "aliasName": null,
          "tag": null,
          "description": "Fetch Devices from OTbase and Creates Assets in FortiSOAR.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1719213471,
          "collection": "/api/3/workflow_collections/0852c21b-b9fc-48b4-bdbe-da7dd06d8298",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/6de0c3d2-67d0-4a95-93d5-5ded9f461537",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": [],
              "status": null,
              "top": "165",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "276ae770-99d9-4c27-b898-e14b317e6e74"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch and Create Devices",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/dfdb72f0-f9ea-4b04-8b6c-3af2c50e3295"
              },
              "status": null,
              "top": "300",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "f3ba5172-7e76-4d8d-a705-b04c544bce6b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "__triggerLimit": true,
                "step_variables": {
                  "input": {
                    "params": []
                  }
                },
                "triggerOnSource": true,
                "triggerOnReplicate": false
              },
              "status": null,
              "top": "30",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "6de0c3d2-67d0-4a95-93d5-5ded9f461537"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Last Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.steps.Fetch_and_Create_Devices.macro_name}}",
                  "value": "{{vars.steps.Fetch_and_Create_Devices.updated_last_pull_time}}"
                },
                "version": "3.3.1",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Create/Update Global Variables",
                "step_variables": []
              },
              "status": null,
              "top": "435",
              "left": "125",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "66ec53f2-8da0-4441-a0d9-916377d4d019"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Fetch and Create Devices",
              "targetStep": "/api/3/workflow_steps/f3ba5172-7e76-4d8d-a705-b04c544bce6b",
              "sourceStep": "/api/3/workflow_steps/276ae770-99d9-4c27-b898-e14b317e6e74",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "e10c4820-1c92-461f-bda9-57c1b0960b86"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch and Create Devices -> Update Last Pull Time",
              "targetStep": "/api/3/workflow_steps/66ec53f2-8da0-4441-a0d9-916377d4d019",
              "sourceStep": "/api/3/workflow_steps/f3ba5172-7e76-4d8d-a705-b04c544bce6b",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "807f2b92-5f96-4d48-ac5b-004cf1ff4cfd"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/276ae770-99d9-4c27-b898-e14b317e6e74",
              "sourceStep": "/api/3/workflow_steps/6de0c3d2-67d0-4a95-93d5-5ded9f461537",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "27d9cf13-7029-43dc-9f2a-f0ff21d85833"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "e12d99ae-35a3-49bf-bb9f-c7f80bc3adc6",
          "id": 1080,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "dataingestion",
            "ingest",
            "Otbase",
            "otbase-inventory"
          ]
        }
      ],
      "name": "Sample - OTbase Inventory - 1.1.0",
      "description": "Enterprise-grade OT asset management software. OTbase is the gold standard for large scale OT asset inventories. It inventories OT devices from PLCs over network switches to sensors and actuators and integrates nicely with your existing tools and platforms.",
      "visible": true,
      "recordTags": [
        "Otbase",
        "otbase-inventory"
      ]
    }
  ]
}